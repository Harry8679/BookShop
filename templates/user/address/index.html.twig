{% extends 'base.html.twig' %}

{% block title %}Mes adresses â€” HolyBloom{% endblock %}

{% block body %}
<section class="py-5 bg-light min-vh-100">
  <div class="container">
    <!-- ðŸ·ï¸ En-tÃªte -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold text-holybloom">
        <i class="bi bi-geo-alt-heart me-2"></i> Mes adresses
      </h2>
      <a href="{{ path('app_user_address_add') }}" class="btn btn-holybloom rounded-3 shadow-sm">
        <i class="bi bi-plus-lg me-1"></i> Ajouter une adresse
      </a>
    </div>

    <!-- ðŸ“¦ Liste des adresses -->
    {% if addresses is not empty %}
      <div class="row g-4">
        {% for address in addresses %}
          <div class="col-md-6">
            <div class="card shadow-sm border-0 rounded-4 overflow-hidden address-card">
              <div class="card-body">
                <h5 class="fw-semibold mb-2 text-dark">
                  <i class="bi bi-house-heart me-2 text-holybloom"></i>{{ address.street }}
                </h5>
                <p class="text-muted small mb-1">
                  <i class="bi bi-geo me-1"></i> {{ address.postalCode }} {{ address.city }}
                </p>
                <p class="text-muted small mb-3">
                  <i class="bi bi-globe me-1"></i> {{ address.country }}
                </p>

                <div class="d-flex justify-content-between mt-3">
                  <a href="{{ path('app_user_address_edit', { id: address.id }) }}"
                     class="btn btn-outline-primary btn-sm rounded-3">
                    <i class="bi bi-pencil-square me-1"></i> Modifier
                  </a>

                  <button type="button"
                          class="btn btn-outline-danger btn-sm rounded-3"
                          onclick="confirmDelete('{{ path('app_user_address_delete', { id: address.id }) }}')">
                    <i class="bi bi-trash me-1"></i> Supprimer
                  </button>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-center text-muted mt-5">
        Vous nâ€™avez encore ajoutÃ© aucune adresse.
      </p>
    {% endif %}
  </div>
</section>

<!-- ðŸŒ¸ Styles HolyBloom -->
<style>
  .text-holybloom {
    color: #b97add !important;
  }

  .btn-holybloom {
    background-color: #b97add;
    border: none;
    color: #fff;
    transition: all 0.2s;
  }

  .btn-holybloom:hover {
    background-color: #a25ed1;
    transform: translateY(-2px);
  }

  .address-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .address-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(185, 122, 221, 0.2);
  }
</style>

{% block javascripts %}
  {{ parent() }}

  {# ðŸŒ¸ SweetAlert2 pour un popup moderne et doux #}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script>
    function confirmDelete(url) {
      Swal.fire({
        title: 'ðŸ—‘ï¸ Supprimer cette adresse ?',
        text: "Cette action est irrÃ©versible.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#b97add',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Oui, supprimer',
        cancelButtonText: 'Annuler',
        background: '#fff8ff',
        customClass: {
          popup: 'rounded-4 shadow-lg border border-purple-200',
          title: 'fw-bold text-holybloom',
          confirmButton: 'btn btn-holybloom',
          cancelButton: 'btn btn-outline-danger'
        }
      }).then((result) => {
        if (result.isConfirmed) {
          window.location.href = url;
        }
      });
    }
  </script>
{% endblock %}
{% endblock %}